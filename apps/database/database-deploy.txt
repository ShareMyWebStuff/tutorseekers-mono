-- Database deploy script

-- DeployId|Insert Description|Insert Script|Insert Rows Affected|Uninstall Description|Uninstall Script|Uninstall Rows Affected|Data Filename for bulk loading|Mode

-- Load initial procedures that help create the database
1    |Drop CreateIndex procedure if it exists                      |procedures/helpers/uninstall/create_index_drop.sql                            |         |Drop the CreateIndex procedure                           |procedures/helpers/uninstall/create_index_drop.sql                        |         |                                                  |
2    |Create the CreateIndex procedure                             |procedures/helpers/install/create_index_create.sql                            |         |Drop the CreateIndex procedure                           |procedures/helpers/uninstall/create_index_drop.sql                        |         |                                                  |

-- Drop the geo tables
10   |Drop the geo_countries table                                 |tables/geo/uninstall/geo_countries_drop.sql                                   |         |Drop the geo_countries table                             |tables/geo/uninstall/geo_countries_drop.sql                               |         |                                                  |
11   |Drop the geo_distances table                                 |tables/geo/uninstall/geo_distances_drop.sql                                   |         |Drop the geo_distances table                             |tables/geo/uninstall/geo_distances_drop.sql                               |         |                                                  |
12   |Drop the geo_locations table                                 |tables/geo/uninstall/geo_locations_drop.sql                                   |         |Drop the geo_locations table                             |tables/geo/uninstall/geo_locations_drop.sql                               |         |                                                  |
13   |Drop the geo_postcodes table                                 |tables/geo/uninstall/geo_postcodes_drop.sql                                   |         |Drop the geo_postcodes table                             |tables/geo/uninstall/geo_postcodes_drop.sql                               |         |                                                  |
14   |Drop the geo_regions table                                   |tables/geo/uninstall/geo_regions_drop.sql                                     |         |Drop the geo_regions table                               |tables/geo/uninstall/geo_regions_drop.sql                                 |         |                                                  |

-- Create the geo tables
20   |Create the geo_countries table                               |tables/geo/install/geo_countries_create.sql                                   |         |Drop the geo_countries table                             |tables/geo/uninstall/geo_countries_drop.sql                               |         |                                                  |
21   |Create the geo_distances table                               |tables/geo/install/geo_distances_create.sql                                   |         |Drop the geo_distances table                             |tables/geo/uninstall/geo_distances_drop.sql                               |         |                                                  |
22   |Create the geo_locations table                               |tables/geo/install/geo_locations_create.sql                                   |         |Drop the geo_locations table                             |tables/geo/uninstall/geo_locations_drop.sql                               |         |                                                  |
23   |Create the geo_postcodes table                               |tables/geo/install/geo_postcodes_create.sql                                   |         |Drop the geo_postcodes table                             |tables/geo/uninstall/geo_postcodes_drop.sql                               |         |                                                  |
24   |Create the geo_regions table                                 |tables/geo/install/geo_regions_create.sql                                     |         |Drop the geo_regions table                               |tables/geo/uninstall/geo_regions_drop.sql                                 |         |                                                  |

-- Create geo table indexes
30   |Create geo_distances index from / to location                |indexes/geo/install/geo_distances_from_location_to_location_create.sql        |         |Drop geo_distances index from / to location              |                                                                          |         |                                                  |
31   |Create geo_distances index from location                     |indexes/geo/install/geo_distances_from_location_create.sql                    |         |Drop geo_distances index from location                   |                                                                          |         |                                                  |
32   |Create geo_locations index on country / location             |indexes/geo/install/geo_locations_country_location_create.sql                 |         |Drop geo_locations index on country / location           |                                                                          |         |                                                  |
33   |Create geo_locations index on lc_location                    |indexes/geo/install/geo_locations_lc_location_create.sql                      |         |Drop geo_locations index on lc_location                  |                                                                          |         |                                                  |
34   |Create geo_locations index on location                       |indexes/geo/install/geo_locations_location_create.sql                         |         |Drop geo_locations index on location                     |                                                                          |         |                                                  |
35   |Create geo_postcodes index                                   |indexes/geo/install/geo_postcodes_country_postcode_create.sql                 |         |Drop geo_postcodes index                                 |                                                                          |         |                                                  |
36   |Create geo_postcodes index on lc_location                    |indexes/geo/install/geo_postcodes_lc_location_create.sql                      |         |Drop geo_postcodes index on lc_location                  |                                                                          |         |                                                  |
37   |Create geo_postcodes index on postcode_id                    |indexes/geo/install/geo_postcodes_postcode_id_create.sql                      |         |Drop geo_postcodes index on postcode_id                  |                                                                          |         |                                                  |
38   |Create geo_regions index on lc_region                        |indexes/geo/install/geo_regions_lc_region_create.sql                          |         |Drop geo_regions index on lc_region                      |                                                                          |         |                                                  |
39   |Create geo_regions index on region_id                        |indexes/geo/install/geo_regions_region_id_create.sql                          |         |Drop geo_regions index on region_id                      |                                                                          |         |                                                  |


-- Populate the geo tables
50   |Populate the geo_countries table                             |load-data-scripts/geo/install/geo_countries_00001_insert.sql                  |252      |Reverts the data loaded into geo_countries               |load-data-scripts/geo/uninstall/geo_countries_00001_delete.sql            |         |data/geo/geo_countries.csv                        |
51   |Populate the geo_distances table                             |load-data-scripts/geo/install/geo_distances_00001_insert.sql                  |2615722  |Reverts the data loaded into geo_distances               |load-data-scripts/geo/uninstall/geo_distances_00001_delete.sql            |         |data/geo/geo_distances.csv                        |
52   |Populate the geo_locations table                             |load-data-scripts/geo/install/geo_locations_00001_insert.sql                  |18959    |Reverts the data loaded into geo_locations               |load-data-scripts/geo/uninstall/geo_locations_00001_delete.sql            |         |data/geo/geo_locations.csv                        |
53   |Populate the geo_postcodes table                             |load-data-scripts/geo/install/geo_postcodes_00001_insert.sql                  |1796411  |Reverts the data loaded into geo_postcodes               |load-data-scripts/geo/uninstall/geo_postcodes_00001_delete.sql            |         |data/geo/geo_postcodes.csv                        |
54   |Populate the geo_regions table                               |load-data-scripts/geo/install/geo_regions_00001_insert.sql                    |8142     |Reverts the data loaded into geo_regions                 |load-data-scripts/geo/uninstall/geo_regions_00001_delete.sql              |         |data/geo/geo_regions.csv                          |

-- Create geo procedures and function 
60   |Drop function sf_geo_location_nearest_location_id_get        |functions/geo/uninstall/sf_geo_location_nearest_location_id_get_drop.sql      |         |Drop function sf_geo_location_nearest_location_id_get    |functions/geo/uninstall/sf_geo_location_nearest_location_id_get_drop.sql  |         |                                                  |
61   |Create function sf_geo_location_nearest_location_id_get      |functions/geo/install/sf_geo_location_nearest_location_id_get_create.sql      |         |Drop function sf_geo_location_nearest_location_id_get    |functions/geo/uninstall/sf_geo_location_nearest_location_id_get_drop.sql  |         |                                                  |


-- DROP TABLES
100  |Drop the user_login table                                    |tables/user/uninstall/user_login_drop.sql                                     |         |Drop the user_login table                                |tables/user/uninstall/user_login_drop.sql                                 |         |                                                  |
101  |Drop the user_details table                                  |tables/user/uninstall/user_details_drop.sql                                   |         |Drop the user_details table                              |tables/user/uninstall/user_details_drop.sql                               |         |                                                  |
102  |Drop the user_details_unverified table                       |tables/user/uninstall/user_details_unverified_drop.sql                        |         |Drop the user_details_unverified table                   |tables/user/uninstall/user_details_unverified_drop.sql                    |         |                                                  |
103  |Drop the user_ip_location table                              |tables/user/uninstall/user_ip_location_drop.sql                               |         |Drop the user_ip_location table                          |tables/user/uninstall/user_ip_location_drop.sql                           |         |                                                  |
104  |Drop the user_refresh_tokens table                           |tables/user/uninstall/user_refresh_tokens_drop.sql                            |         |Drop the user_refresh_tokens table                       |tables/user/uninstall/user_refresh_tokens_drop.sql                        |         |                                                  |
105  |Drop the user_verifications table                            |tables/user/uninstall/user_verifications_drop.sql                             |         |Drop the user_verifications table                        |tables/user/uninstall/user_verifications_drop.sql                         |         |                                                  |
106  |Drop the user_verification_code table                        |tables/user/uninstall/user_verification_codes_drop.sql                        |         |Drop the user_verification_code table                    |tables/user/uninstall/user_verification_codes_drop.sql                    |         |                                                  |
107  |Drop the messages_unseen table                               |tables/user/uninstall/messages_unseen_drop.sql                                |         |Drop the messages_unseen table                           |tables/user/uninstall/messages_unseen_drop.sql                            |         |                                                  |


-- CREATE TABLES
200  |Create the user_login table                                  |tables/user/install/user_login.sql                                            |         |Drop the user_login table                                |tables/user/uninstall/user_login_drop.sql                                 |         |                                                  |
201  |Create the user_details table                                |tables/user/install/user_details.sql                                          |         |Drop the user_details table                              |tables/user/uninstall/user_details_drop.sql                               |         |                                                  |
202  |Create the user_details_unverified table                     |tables/user/install/user_details_unverified.sql                               |         |Drop the user_details_unverified table                   |tables/user/uninstall/user_details_unverified_drop.sql                    |         |                                                  |
203  |Create the user_ip_location table                            |tables/user/install/user_ip_location.sql                                      |         |Drop the user_ip_location table                          |tables/user/uninstall/user_ip_location_drop.sql                           |         |                                                  |
204  |Create the user_refresh_tokens table                         |tables/user/install/user_refresh_tokens.sql                                   |         |Drop the user_refresh_tokens table                       |tables/user/uninstall/user_refresh_tokens_drop.sql                        |         |                                                  |
205  |Create the user_verifications table                          |tables/user/install/user_verifications.sql                                    |         |Drop the user_verifications table                        |tables/user/uninstall/user_verifications_drop.sql                         |         |                                                  |
206  |Create the user_verification_code table                      |tables/user/install/user_verification_codes.sql                               |         |Drop the user_verification_code table                    |tables/user/uninstall/user_verification_codes_drop.sql                    |         |                                                  |
207  |Create the messages_unseen table                             |tables/user/install/messages_unseen.sql                                       |         |Drop the messages_unseen table                           |tables/user/uninstall/messages_unseen_drop.sql                            |         |                                                  |

-- DROP INDEXES
300  |Drop user_login index email                                  |indexes/user/uninstall/user_login__email_drop.sql                             |         |Drop user_login index email                              |indexes/user/uninstall/user_login__email_drop.sql                         |         |                                                  |
301  |Drop user_login index google id                              |indexes/user/uninstall/user_login__google_id_drop.sql                         |         |Drop user_login index google id                          |indexes/user/uninstall/user_login__google_id_drop.sql                     |         |                                                  |
302  |Drop user_refresh_tokens index refresh_token                 |indexes/user/uninstall/user_refresh_tokens__refresh_token_drop.sql            |         |Drop user_refresh_tokens index refresh_token             |indexes/user/uninstall/user_refresh_tokens__refresh_token_drop.sql        |         |                                                  |
303  |Drop user_verifications index outstanding                    |indexes/user/uninstall/user_verifications__outstanding_drop.sql               |         |Drop user_verifications index outstanding                |indexes/user/uninstall/user_verifications__outstanding_drop.sql           |         |                                                  |
304  |Drop user_verification_code index verification_code          |indexes/user/uninstall/user_verification_codes__verification_code_drop.sql    |         |Drop user_verification_code index verification_code      |indexes/user/uninstall/user_verification_codes__verification_code_drop.sql|         |                                                  |

-- CREATE INDEXES
400  |Create user_login index email                                |indexes/user/install/user_login__email_create.sql                             |         |Drop user_login index email                              |indexes/user/uninstall/user_login__email_drop.sql                         |         |                                                  |
401  |Create user_login index google id                            |indexes/user/install/user_login__google_id_create.sql                         |         |Drop user_login index google id                          |indexes/user/uninstall/user_login__google_id_drop.sql                     |         |                                                  |
402  |Create user_refresh_tokens index refresh_token               |indexes/user/install/user_refresh_tokens__refresh_token_create.sql            |         |Drop user_refresh_tokens index refresh_token             |indexes/user/uninstall/user_refresh_tokens__refresh_token_drop.sql        |         |                                                  |
403  |Create user_verifications index outstanding                  |indexes/user/install/user_verifications__outstanding_create.sql               |         |Drop user_verifications index outstanding                |indexes/user/uninstall/user_verifications__outstanding_drop.sql           |         |                                                  |
404  |Create user_verification_code index verification_code        |indexes/user/install/user_verification_codes__verification_code.sql           |         |Drop user_verification_code index verification_code      |indexes/user/uninstall/user_verification_codes__verification_code_drop.sql|         |                                                  |

-- DROP PROCEDURES
500  |Drop sp_registration_complete procedure if it exists         |procedures/helpers/uninstall/sp_registration_complete_drop.sql                |         |Drop the sp_registration_complete procedure              |procedures/helpers/uninstall/sp_registration_complete_drop.sql            |         |                                                  |
501  |Drop sp_user_ip_ins procedure if it exists                   |procedures/helpers/uninstall/sp_user_ip_ins_drop.sql                          |         |Drop the sp_user_ip_ins procedure                        |procedures/helpers/uninstall/sp_user_ip_ins_drop.sql                      |         |                                                  |
502  |Drop sp_user_verification_code_ins procedure if it exists    |procedures/helpers/uninstall/sp_user_verification_code_ins_drop.sql           |         |Drop the sp_user_verification_code_ins procedure         |procedures/helpers/uninstall/sp_user_verification_code_ins_drop.sql       |         |                                                  |

-- CREATE PROCEDURES
600  |Create the sp_registration_complete procedure                |procedures/helpers/install/sp_registration_complete.sql                       |         |Drop the sp_registration_complete procedure              |procedures/helpers/uninstall/sp_registration_complete_drop.sql            |         |                                                  |
601  |Create the sp_user_ip_ins procedure                          |procedures/helpers/install/sp_user_ip_ins.sql                                 |         |Drop the sp_user_ip_ins procedure                        |procedures/helpers/uninstall/sp_user_ip_ins_drop.sql                      |         |                                                  |
602  |Create the sp_user_verification_code_ins procedure           |procedures/helpers/install/sp_user_verification_code_ins.sql                  |         |Drop the sp_user_verification_code_ins procedure         |procedures/helpers/uninstall/sp_user_verification_code_ins_drop.sql       |         |                                                  |
