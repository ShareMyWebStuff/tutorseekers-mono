{"version":3,"file":"get-vpc-regions.js","sourceRoot":"/","sources":["src/get-vpc-regions.ts"],"names":[],"mappings":"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","sourcesContent":["import { REGIONS, DOMAINS, WEBSITE_SETUP } from \"./config\";\r\n\r\ntype T_VPCS_CREATE = {\r\n  [key: string]: {\r\n    region: string;\r\n    awsRegion: string;\r\n    frontendDomains: string[];\r\n    backendDomains: string[];\r\n    frontend: boolean;\r\n    backend: boolean;\r\n  };\r\n};\r\n\r\n/**\r\n *\r\n */\r\nexport const getVpcRegions = () => {\r\n  const vpsToCreate: T_VPCS_CREATE = {};\r\n\r\n  Object.values(WEBSITE_SETUP).forEach((website) => {\r\n    // Loop throug frontends\r\n    website.frontend.forEach((frontend) => {\r\n      if (\r\n        frontend.subDomain !== undefined &&\r\n        !!frontend.domainNameId &&\r\n        !!frontend.region\r\n      ) {\r\n        const reg = REGIONS[frontend.region];\r\n        const { domainName } = DOMAINS[frontend.domainNameId];\r\n\r\n        if (!vpsToCreate[frontend.region]) {\r\n          vpsToCreate[frontend.region] = {\r\n            ...reg,\r\n            frontendDomains: [domainName],\r\n            backendDomains: [],\r\n            frontend: true,\r\n            backend: false,\r\n          };\r\n        } else {\r\n          const awsRegionExists = !!vpsToCreate[frontend.region];\r\n          if (awsRegionExists) {\r\n            vpsToCreate[frontend.region].frontend = true;\r\n\r\n            // Add doamin name\r\n            const domainNameExists = vpsToCreate[\r\n              frontend.region\r\n            ].frontendDomains.find((dn) => dn === domainName);\r\n            if (!domainNameExists) {\r\n              vpsToCreate[frontend.region].frontendDomains.push(domainName);\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // Loop through backends\r\n      console.log(\"HERE 00000000000000000000000000000000000000000000\");\r\n      console.log(frontend);\r\n      frontend.backend.forEach((backend) => {\r\n        // Add backend\r\n        console.log(backend);\r\n        if (\r\n          backend.subDomain !== undefined &&\r\n          !!backend.domainNameId &&\r\n          !!backend.region\r\n        ) {\r\n          const reg = REGIONS[backend.region];\r\n          const { domainName } = DOMAINS[backend.domainNameId];\r\n\r\n          if (!vpsToCreate[backend.region]) {\r\n            vpsToCreate[backend.region] = {\r\n              ...reg,\r\n              frontendDomains: [],\r\n              backendDomains: [domainName],\r\n              frontend: false,\r\n              backend: true,\r\n            };\r\n          } else {\r\n            const awsRegionExists = !!vpsToCreate[backend.region];\r\n            if (awsRegionExists) {\r\n              vpsToCreate[backend.region].backend = true;\r\n\r\n              // Add doamin name\r\n              const domainNameExists = vpsToCreate[\r\n                backend.region\r\n              ].backendDomains.find((dn) => dn === domainName);\r\n              if (!domainNameExists) {\r\n                vpsToCreate[backend.region].backendDomains.push(domainName);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n  });\r\n\r\n  console.log(\"vpsToCreate\");\r\n  console.log(vpsToCreate);\r\n\r\n  return vpsToCreate;\r\n};\r\n"]}